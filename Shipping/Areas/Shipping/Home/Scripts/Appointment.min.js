$.widget("ui.timespinner",$.ui.spinner,{options:{step:900},_parse:function(n){if(!n)return null;switch($.type(n)){case"string":var t=n.split(/[\s:]+/);t[2]=="PM"&&Number(t[0])<12?t[0]=(Number(t[0])+12)%24:t[2]=="AM"&&t[0]==12&&(t[0]=0);n=new Date(1970,1,1,t[0],t[1]);case"date":return Number(n)/1e3;case"number":return n;default:alert("Unexpected parse in timespinner")}},_format:function(n){return n=new Date(n*1e3),$.fullCalendar.formatDate(n,"h:mm TT")}});$(document).ready(function(){var n,t;$("#dlgAppointment").dialog({autoOpen:!1,width:"auto",modal:!0,cache:!1,closeOnEscape:!0,create:function(){$("#tbAppointmentDate").datepicker({showOn:"button",buttonImage:$("#tbAppointmentDate").attr("data-image-url"),buttonImageOnly:!0,dateFormat:"m/d/yy",onSelect:function(){$(this).change()}});$("#tbAppointmentTime").timespinner()},open:function(){var n=$(this).dialog("option","currentEvent");$("input:text, select, textarea",this).each(function(){$(this).val(n[$(this).attr("name")])});$("#tbAppointmentDate").val($.datepicker.formatDate("m/d/yy",n.start));n.id?$("#tbAppointmentTime").timespinner("value",n.start):$("#tbAppointmentTime").timespinner("value",420);$("#divAjaxError").html("").removeClass("field-validation-error").addClass("filed-validation-valid")},buttons:[{text:"Save",click:function(){var i=!0,t=$("#ddlBuilding").val(),u,r;$("#ddlBuilding").toggleClass("ui-state-error",!t);i=i&&t;t=$("#tbAppointmentDate").val();try{$.datepicker.parseDate("m/d/yy",t)}catch(f){t=!1}if($("#tbAppointmentDate").toggleClass("ui-state-error",!t),i=i&&t,u=$("#tbAppointmentTime").timespinner("value"),t=u&&$.isNumeric(u),$("#tbAppointmentTime").toggleClass("ui-state-error",!t),i=i&&t,i)return r=$("input:text, select, textarea",this).map(function(){return{name:$(this).attr("name"),value:$(this).is("#tbAppointmentTime")?$("#tbAppointmentTime").timespinner("value"):$(this).val()}}).get(),r.push({name:"id",value:$(this).dialog("option","currentEvent").id}),r.push({name:"RowSequence",value:$(this).dialog("option","currentEvent").RowSequence}),$.ajax({url:$("#calendar").attr("data-createupdate-url"),type:"POST",data:r,context:this,success:function(t,i,r){if(r.status==203)return $("#divAjaxError").html(t).addClass("field-validation-error"),!1;$(this).dialog("close");$("#calendar").fullCalendar("refetchEvents");var u=$.fullCalendar.parseDate(t.start);$("#calendar").fullCalendar("gotoDate",u);n.done(function(){var n=$("#calendar").fullCalendar("clientEvents",t.id);n.length>0&&(n[0].className="ui-selected",$("#calendar").fullCalendar("rerenderEvents"))})},error:function(n){alert(n.responseText)}}),!1}},{text:"Cancel",click:function(){return $(this).dialog("close"),!1}}]});$("#calendar").each(function(){var i=this,r,f=$(this).attr("data-userLogged-in"),t=$(this).attr("data-initial-date"),u=$(this).attr("data-initial-appId");t&&(t=$.fullCalendar.parseISO8601(t,!1));$(this).fullCalendar({dayClick:function(n,t,r){if($(r.target).is(".app-addevent")){$("#dlgAppointment").dialog("option",{title:"Create New Appointment",currentEvent:{start:n}}).dialog("open");return}$(r.target).is(".fc-day-number")&&$(i).fullCalendar("gotoDate",n).fullCalendar("changeView","basicDay")},loading:function(n){$("#calendarLoading").toggleClass("ui-autocomplete-loading",n).toggle(n)},weekends:!0,editable:!1,disableResizing:!0,defaultEventMinutes:120,theme:!0,header:{left:"prev,next today",center:"title",right:"month,basicWeek,basicDay"},timeFormat:"h:mm TT",ignoreTimezone:!1,defaultView:t?"basicDay":"basicWeek",eventClick:function(n,t){$(i).trigger(t,n);t.stopImmediatePropagation()},lazyFetching:!0,allDayDefault:!1,events:function(t,r,f){var e=$("#divBuildings input:checkbox:checked,#divFilter input:radio:checked,#tbCarrierFilter,#divShipped input:checkbox:checked").map(function(){return{name:$(this).attr("name"),value:$(this).val()}}).get();e.push({name:$(i).attr("data-start-param"),value:Math.round(+t/1e3)});e.push({name:$(i).attr("data-end-param"),value:Math.round(+r/1e3)});e.push({name:$(i).attr("data-viewname-param"),value:$(i).fullCalendar("getView").name});n=$.ajax({url:$(i).attr("data-event-url"),dataType:"json",data:e,traditional:!0,cache:!1,success:function(t){f(t);u&&n.done(function(){var n=$("#calendar").fullCalendar("clientEvents",u);n.length>0&&(n[0].className="ui-selected",$("#calendar").fullCalendar("rerenderEvents"))})},error:function(n){alert(n.responseText);f([])}})},eventRender:function(n,t){if($(".fc-event-inner .fc-event-time",t).attr("title",n.Remarks),n.appointmentHtml&&$(".fc-event-inner",t).append(n.appointmentHtml),n.id){var i=$.fullCalendar.parseDate(n.InitialDateIso),r=new Date;n.OffSet.TotalMinutes+r.getTimezoneOffset()!=0&&($(".fc-event-title",t).prepend("(Local:-"+$.fullCalendar.formatDate(i,"h:mm TT")+")"),$(".fc-event-title",t).attr("title",n.AppointmentOffsetDisplay))}},viewDisplay:function(n){f=="True"&&$("td > div:not(:has(span.app-addevent))",this).prepend('<span title="Create a new event" class="app-addevent ui-icon ui-icon-plus"><\/span>');$("div.fc-view-basicDay thead th:not(:has(span.app-refresh))",this).prepend('<span title="Refresh" class="ui-icon ui-icon-refresh app-refresh"><\/span>');$("td div.fc-day-number, div.fc-view-basicWeek thead th",this).attr("title","Click to see the day view");r&&r!=n.name&&$(this).fullCalendar("refetchEvents");r=n.name},year:t?t.getFullYear():undefined,month:t?t.getMonth():undefined,date:t?t.getDate():undefined})}).on("click","span.ui-icon-close",function(n){$(n.target).parent("span.arrival-editor").find("input:text").timespinner("destroy").end().hide().nextAll("a.arrival-editor-button").show()}).on("click","span.ui-icon-check",function(n,t){var i={},r=$(n.target).parent("span.arrival-editor").find("input:text").each(function(){i[$(this).attr("name")]=$(this).timespinner("value")}).end();i[$(n.delegateTarget).attr("data-id-param")]=t.id;i[$(n.delegateTarget).attr("data-appointmentTime-param")]=Number(t.start)/1e3;$.ajax({url:$(n.delegateTarget).attr("data-updatearrival-url"),data:i,cache:!1,type:"POST",context:n.delegateTarget}).done(function(){$(this).fullCalendar("refetchEvents")}).error(function(n){alert(n.responseText)}).always(function(){$("span.ui-icon-close",r).click()})}).on("click","span.app-refresh",function(){$("#calendar").fullCalendar("refetchEvents")}).on("click","a.arrival-editor-button",function(n){return $(n.target).prevAll("span.arrival-editor").show().find("input:text").timespinner(),$(n.target).hide(),!1}).on("click","a.app-edit",function(n,t){$("#dlgAppointment").dialog("option",{title:"Edit Appointment",currentEvent:t}).dialog("open")}).on("click","a.app-delete",function(n,t){var i=confirm("Are you sure, you want to delete Appointment "+t.title+" ?");i&&$.ajax({url:$(n.delegateTarget).attr("data-delete-url").replace(-1,t.id),type:"POST",data:t.id,success:function(n){$("#divAppntDltdError").html(n).addClass("ui-state-highlight");$("#calendar").fullCalendar("refetchEvents")},error:function(n){alert(n.responseText)}})}).on("click","div.fc-view-basicWeek thead",function(n){var r=$("th",n.currentTarget).index($(n.target)),t=$(n.delegateTarget).fullCalendar("getView"),i=new Date(t.start);i.setDate(t.start.getDate()+r);$(n.delegateTarget).fullCalendar("gotoDate",i).fullCalendar("changeView","basicDay")});$("#calendarLoading").position({of:$(window)});$("#tbCarrier,#tbCarrierFilter").autocomplete({minLength:0,source:function(n,t){$.ajax({url:this.element.attr("data-list-url"),dataType:"json",context:this.element,beforeSend:function(){this.addClass("ui-autocomplete-loading")},data:{term:n.term},success:function(n){t(n)},error:function(n){alert(n.responseText)},complete:function(){this.removeClass("ui-autocomplete-loading")}})},change:function(){$(this).change()},select:function(){$("#divFilter").change()},autoFocus:!0}).dblclick(function(){$(this).autocomplete("search")});$("#divBuildings, #divFilter, #divShipped").on("change",function(){t==null&&(t=setTimeout(function(){$("#calendar").fullCalendar("refetchEvents");t=null},1e3))});$("#tbGotoAppointmentDate").datepicker({showOn:"button",buttonImage:$("#tbGotoAppointmentDate").attr("data-image-url"),buttonImageOnly:!0,dateFormat:"m/d/yy",onSelect:function(){$(this).change()}}).change(function(){if($(this).val()){var n=new Date($(this).val());$("#calendar").fullCalendar("gotoDate",n).fullCalendar("changeView","basicDay")}});$("#btnAppNumber").click(function(){var t=$("#tbAppointmentNumber").val();if(isNaN(t)){alert("Appointment number must be a number.");$("#tbAppointmentNumber").val("");return}if(!t){$("#tbAppointmentNumber").val("");return}$("#tbAppointmentNumber").val("");$.ajax({url:$(this).attr("data-url").replace("-1",t)}).done(function(i,r,u){if(u.status==203){alert("Appointment Number "+t+" not found");return}var f=$.fullCalendar.parseISO8601(i.start,!1);$("#calendar").fullCalendar("gotoDate",f).fullCalendar("changeView","basicDay");n.done(function(){var n=$("#calendar").fullCalendar("clientEvents",i.id);n.length>0?(n[0].className="ui-selected",$("#calendar").fullCalendar("rerenderEvents")):alert("Appointment Number "+t+" not found")})}).error(function(n){alert(n.responseText)})}).button()});
//# sourceMappingURL=Appointment.min.js.map